<!DOCTYPE HTML>
<!--
	Massively by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Cyprien Vittoz Portfolio</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<link href="assets/css/prism.css" rel="stylesheet" />
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
	</head>
	<body class="is-preload">

		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Header -->
					<header id="header">
						<a href="index.html" class="logo">Cyprien C. Vittoz</a>
					</header>

				<!-- Nav -->
				<nav id="nav">
					<ul class="links">
						<li id="nav-python"><a href="index.html#header">Python</a></li>
						<li id="nav-r"><a href="R_index.html#header">R</a></li>
						<li id="nav-powerbi"><a href="Power_Bi_index.html#header">Power Bi</a></li>
						<li id="nav-tableau"><a href="Tableau_index.html#header">Tableau</a></li>
						<li id="nav-sql"><a href="SQL_index.html#header">SQL</a></li>
						<li id="nav-about" class="right-aligned"><a href="About_me.html#header">About Me</a></li>
					</ul>
					<ul class="icons">
						<li><a href="https://www.linkedin.com/in/vittozcyprien/" class="icon brands fa-linkedin" target="_blank"><span class="label">LinkedIn</span></a></li>
					</ul>
				</nav>

				<!-- Main -->
					<div id="main">
					
						<ul class="actions" style="display: flex; justify-content: space-between; width: 100%;">
							<li><a href="R_index.html#nav" class="button small">< Other R Projects</a></li>
							<li><a href="mushroom_python.html?from=index.html#header" class="button small">Same Project in Python ></a></li>
						</ul>						

						<!-- Post -->
							<section class="post">
								<header class="major">
									<h2>Mushroom Toxicity Predictor</h2>
									<p>In this project, we will implement a random forest classifier in R to predict the toxicity of mushrooms 
										based on their characteristics and build a web application using Shiny to make the model accessible to users.
									</p>
								</header>
								<div class="image main"><img src="images/mushroom2.jpg" alt="" /></div>
								<ul class="actions">
									<li><a href="#intromushr" class="button small">Introduction</a></li>
									<li><a href="#datamushr" class="button small">Data</a></li>
									<li><a href="#vizmushr" class="button small">Exploration</a></li>
									<li><a href="#descmushr" class="button small">Model</a></li>
									<li><a href="#webmushr" class="button small">Web App</a></li>
								</ul>
								<hr />
								<h3 id="intromushr">Introduction</h3>
								<p>Before delving into this project, it's important to clarify what we aim to achieve and the means by which we plan to do so. Imagine being lost in a forest
									 or locked inside a laboratory with a bunch of mushrooms. In the first few days, we might survive on the water from the mushrooms, but eventually, we will 
									 need to eat them. The problem is that some mushrooms are toxic and could harm or kill us. Therefore, we need to find a way to differentiate between toxic 
									 and non-toxic mushrooms. However, large databases may not be useful if you don't know the name of the mushroom you're looking for, and you may also lack 
									 access to the internet.
								</p>
								<p>
									To solve this problem and help people who might find themselves in such a situation, we can develop a machine learning model, implement it in an application, 
									and make it accessible to everyone. For practicality, this will be presented as a web application, but the app can easily be downloaded and used offline.
								</p>
								<hr />
								<h3 id="datamushr">Data</h3>
								<p>
									The data used in this project is the <a href="https://archive.ics.uci.edu/dataset/73/mushroom" target="_blank">Mushroom Classification</a> dataset from UCI 
									Machine Learning Repository. It includes descriptions of gilled mushroom species in the Agaricus and Lepiota families, first documented in 
									<a href="https://www.amazon.com/National-Audubon-Society-American-Mushrooms/dp/0394519922" target="_blank">The Audubon 
										Society Field Guide to North American Mushrooms (1981)</a> from G.H. Lincoff.

									This dataset contains 8124 rows and 22 columns which look like this after removing the NA values and renaming the columns:
								</p>

								<div id="tab-container-1" class="tab-container">
									<div class="tabs">
										<button class="tab-link" onclick="openTab(event, 'Content1','tab-container-1')">Table</button>
										<button class="tab-link" onclick="openTab(event, 'Content2','tab-container-1')">Code</button>
									</div>
								
									<div id="Content1" class="tab-content">
										<div class="table-wrapper">
											<table  class="alt">
													<tr>
													  <th>poisonous</th>
													  <th>cap-shape</th>
													  <th>cap-surface</th>
													  <th>cap-color</th>
													  <th>bruises</th>
													  <th>odor</th>
													  <th>gill-attachment</th>
													  <th>gill-spacing</th>
													  <th>gill-size</th>
													  <th>gill-color</th>
													  <th>stalk-shape</th>
													  <th>stalk-root</th>
													  <th>stalk-surface-above-ring</th>
													  <th>stalk-surface-below-ring</th>
													  <th>stalk-color-above-ring</th>
													  <th>stalk-color-below-ring</th>
													  <th>veil-type</th>
													  <th>veil-color</th>
													  <th>ring-number</th>
													  <th>ring-type</th>
													  <th>spore-print-color</th>
													  <th>population</th>
													  <th>habitat</th>
													</tr>
													<tr>
													  <td>p</td>
													  <td>x</td>
													  <td>s</td>
													  <td>n</td>
													  <td>t</td>
													  <td>p</td>
													  <td>f</td>
													  <td>c</td>
													  <td>n</td>
													  <td>k</td>
													  <td>e</td>
													  <td>e</td>
													  <td>s</td>
													  <td>s</td>
													  <td>w</td>
													  <td>w</td>
													  <td>p</td>
													  <td>w</td>
													  <td>o</td>
													  <td>p</td>
													  <td>k</td>
													  <td>s</td>
													  <td>u</td>
													</tr>
													<tr>
													  <td>e</td>
													  <td>x</td>
													  <td>s</td>
													  <td>y</td>
													  <td>t</td>
													  <td>a</td>
													  <td>f</td>
													  <td>c</td>
													  <td>b</td>
													  <td>k</td>
													  <td>e</td>
													  <td>c</td>
													  <td>s</td>
													  <td>s</td>
													  <td>w</td>
													  <td>w</td>
													  <td>p</td>
													  <td>w</td>
													  <td>o</td>
													  <td>p</td>
													  <td>n</td>
													  <td>n</td>
													  <td>g</td>
													</tr>
													<tr>
													  <td>e</td>
													  <td>b</td>
													  <td>s</td>
													  <td>w</td>
													  <td>t</td>
													  <td>l</td>
													  <td>f</td>
													  <td>c</td>
													  <td>b</td>
													  <td>n</td>
													  <td>e</td>
													  <td>c</td>
													  <td>s</td>
													  <td>s</td>
													  <td>w</td>
													  <td>w</td>
													  <td>p</td>
													  <td>w</td>
													  <td>o</td>
													  <td>p</td>
													  <td>n</td>
													  <td>n</td>
													  <td>m</td>
													</tr>
													<tr>
													  <td>p</td>
													  <td>x</td>
													  <td>y</td>
													  <td>w</td>
													  <td>t</td>
													  <td>p</td>
													  <td>f</td>
													  <td>c</td>
													  <td>n</td>
													  <td>n</td>
													  <td>e</td>
													  <td>e</td>
													  <td>s</td>
													  <td>s</td>
													  <td>w</td>
													  <td>w</td>
													  <td>p</td>
													  <td>w</td>
													  <td>o</td>
													  <td>p</td>
													  <td>k</td>
													  <td>s</td>
													  <td>u</td>
													</tr>
													<tr>
													  <td>e</td>
													  <td>x</td>
													  <td>s</td>
													  <td>g</td>
													  <td>f</td>
													  <td>n</td>
													  <td>f</td>
													  <td>w</td>
													  <td>b</td>
													  <td>k</td>
													  <td>t</td>
													  <td>e</td>
													  <td>s</td>
													  <td>s</td>
													  <td>w</td>
													  <td>w</td>
													  <td>p</td>
													  <td>w</td>
													  <td>o</td>
													  <td>e</td>
													  <td>n</td>
													  <td>a</td>
													  <td>g</td>
													</tr>
											</table>
										</div>
									</div>
								
									<div id="Content2" class="tab-content">
								
										<pre class="language-r">
<code>library(dplyr)  

# Load the data
mushroom <- read.table("agaricus-lepiota.data", 
                       header = FALSE, 
                       sep = ",")

#Load the Variable names
namefile <- read.delim("agaricus-lepiota.txt", 
                       sep = "/", # to import it as a single string
                       header = FALSE,
                       stringsAsFactors = FALSE)

# Fix the table
trim_leading_spaces <- function(x) {
    gsub("^\\s+", "", x)
}

namefile <- data.frame(lapply(namefile, trim_leading_spaces), stringsAsFactors = FALSE)

merge_non_numeric <- function(x) {
    for (i in 2:length(x)) {
        if (!grepl("^[0-9]", x[i])) {
            x[i-1] <- paste0(x[i-1], " ", x[i])
            x[i] <- NA
        }
    }
    return(x)
}
namefile <- data.frame(lapply(namefile, merge_non_numeric), stringsAsFactors = FALSE)
namefile <- data.frame(lapply(namefile, merge_non_numeric), stringsAsFactors = FALSE) #twice because of the values on 3 lines

namefile <- data.frame(lapply(namefile, function(x) gsub("\\bNA\\b\\s*", "", x)))
namefile <- na.omit(namefile)
namefile <- namefile[apply(namefile != "", 1, all), ]
namelist <- trimws(sub("^.{3}(.*?):.*", "\\1", namefile))

#remove NA
rows_to_delete <- apply(mushroom, 1, function(row) any(row == "?"))
mushroom <- mushroom[!rows_to_delete, ]

#Combine the two
colnames(mushroom) <- namelist

# Display
head(mushroom,5)</code>
								</pre>
								
									</div>
									</div>
									<br />
									<p>The new table contains 5644 individuals once NA values are removed. As you may notice, the dataset contains only discrete, non-ordered values but that are coded with letters. It lacks clarity, and our next step is to
										convert these letters into words. This is where the downloadable file <a href="https://archive.ics.uci.edu/dataset/73/mushroom" target="_blank">agaricus-lepiota.names</a> 
										(renamed afterward agaricus-lepiota.txt as a copy that only features the relevant section and we already imported it to name the columns of the previous table)
										 provided by the UCI Repository comes handy. For example,we can read in it: <br><br>
										<i>" 1. cap-shape: bell=b, conical=c, convex=x, flat=f, knobbed=k, sunken=s"</i><br><br>
										We will first list for each column the possible values and their corresponding words. Then we can replace the coded values with their proper words.
								   </p>

								   <div id="tab-container-2" class="tab-container">
									<div class="tabs">
										<button class="tab-link" onclick="openTab(event, 'Content3', 'tab-container-2')">Table</button>
										<button class="tab-link" onclick="openTab(event, 'Content4', 'tab-container-2')">Code</button>
									</div>
								
									<div id="Content3" class="tab-content">
										<div class="table-wrapper">
											<table class="alt">
												<tr>
												  <th>Letter</th>
												  <th>poisonous</th>
												  <th>cap-shape</th>
												  <th>cap-surface</th>
												  <th>cap-color</th>
												  <th>bruises</th>
												  <th>odor</th>
												  <th>gill-attachment</th>
												  <th>gill-spacing</th>
												  <th>gill-size</th>
												  <th>gill-color</th>
												  <th>stalk-shape</th>
												  <th>stalk-root</th>
												  <th>stalk-surface-above-ring</th>
												  <th>stalk-surface-below-ring</th>
												  <th>stalk-color-above-ring</th>
												  <th>stalk-color-below-ring</th>
												  <th>veil-type</th>
												  <th>veil-color</th>
												  <th>ring-number</th>
												  <th>ring-type</th>
												  <th>spore-print-color</th>
												  <th>population</th>
												  <th>habitat</th>
												</tr>
												<tr>
												  <td>a</td>
												  <td></td>
												  <td></td>
												  <td></td>
												  <td></td>
												  <td></td>
												  <td>almond</td>
												  <td>attached</td>
												  <td></td>
												  <td></td>
												  <td></td>
												  <td></td>
												  <td></td>
												  <td></td>
												  <td></td>
												  <td></td>
												  <td></td>
												  <td></td>
												  <td></td>
												  <td></td>
												  <td></td>
												  <td></td>
												  <td>abundant</td>
												  <td></td>
												</tr>
												<tr>
												  <td>b</td>
												  <td></td>
												  <td>bell</td>
												  <td></td>
												  <td>buff</td>
												  <td></td>
												  <td></td>
												  <td></td>
												  <td></td>
												  <td>broad</td>
												  <td>buff</td>
												  <td></td>
												  <td>bulbous</td>
												  <td></td>
												  <td></td>
												  <td>buff</td>
												  <td>buff</td>
												  <td></td>
												  <td></td>
												  <td></td>
												  <td></td>
												  <td>buff</td>
												  <td></td>
												  <td></td>
												</tr>
												<tr>
												  <td>c</td>
												  <td></td>
												  <td>conical</td>
												  <td></td>
												  <td>cinnamon</td>
												  <td></td>
												  <td>creosote</td>
												  <td></td>
												  <td>close</td>
												  <td></td>
												  <td></td>
												  <td></td>
												  <td>club</td>
												  <td></td>
												  <td></td>
												  <td>cinnamon</td>
												  <td>cinnamon</td>
												  <td></td>
												  <td></td>
												  <td></td>
												  <td>cobwebby</td>
												  <td></td>
												  <td>clustered</td>
												  <td></td>
												</tr>
												<tr>
												  <td>d</td>
												  <td></td>
												  <td></td>
												  <td></td>
												  <td></td>
												  <td></td>
												  <td></td>
												  <td>descending</td>
												  <td>distant</td>
												  <td></td>
												  <td></td>
												  <td></td>
												  <td></td>
												  <td></td>
												  <td></td>
												  <td></td>
												  <td></td>
												  <td></td>
												  <td></td>
												  <td></td>
												  <td></td>
												  <td></td>
												  <td></td>
												  <td>woods</td>
												</tr>
												<tr>
													<td>e</td>
													<td>edible</td>
													<td></td>
													<td></td>
													<td>red</td>
													<td></td>
													<td></td>
													<td></td>
													<td></td>
													<td></td>
													<td>red</td>
													<td>enlarging</td>
													<td>equal</td>
													<td></td>
													<td></td>
													<td>red</td>
													<td>red</td>
													<td></td>
													<td></td>
													<td></td>
													<td>evanescent</td>
													<td></td>
													<td></td>
													<td></td>
												  </tr>
											  </table>
											  
												</div>
											</div>
										
											<div id="Content4" class="tab-content">
												<pre class="language-r">
<code># Simplify the data
namefile <- substr(namefile, 30, nchar(namefile))
namefile <- gsub(" ", "", namefile)
df1 <- do.call(rbind, strsplit(namefile, ","))
rownames(df1) <- namelist
df1 <- as.data.frame(df1)

# Create the output dataframe
alphabet <- letters 
new_df <- data.frame(matrix(NA, nrow=length(namelist), ncol=26, dimnames=list(namelist, alphabet)))

# Fill the output dataframe
for (i in seq_along(df1[,1])) {
    for (j in seq_along(df1[i, ])) {
        value <- df1[i, j]
        last_char <- substring(value, nchar(value))  
        if (last_char %in% alphabet) {
            new_df[i, last_char] <- value  
        }
    }
}

# Clean the strings
new_df <- apply(new_df, 2, function(x) {
    trimws(substring(x, 1, nchar(x)-2))
})
new_df[is.na(new_df)] <- ""

# Create a dataframe matching the letters and their corresponding words
name_codex <- as.data.frame(t(new_df))
head(name_codex, 5)</code>
					</pre>
										
											</div>
											</div>
											<br>
											<br>
											<p>Now we can apply these transformations to the dataset itself:</p>
											<div id="tab-container-3" class="tab-container">
												<div class="tabs">
													<button class="tab-link" onclick="openTab(event, 'Content5', 'tab-container-3')">Table</button>
													<button class="tab-link" onclick="openTab(event, 'Content6', 'tab-container-3')">Code</button>
												</div>
											
												<div id="Content5" class="tab-content">
													<div class="table-wrapper">
														<table class="alt">
																<tr>
																	<th>poisonous</th>
																	<th>cap-shape</th>
																	<th>cap-surface</th>
																	<th>cap-color</th>
																	<th>bruises</th>
																	<th>odor</th>
																	<th>gill-attachment</th>
																	<th>gill-spacing</th>
																	<th>gill-size</th>
																	<th>gill-color</th>
																	<th>stalk-shape</th>
																	<th>stalk-root</th>
																	<th>stalk-surface-above-ring</th>
																	<th>stalk-surface-below-ring</th>
																	<th>stalk-color-above-ring</th>
																	<th>stalk-color-below-ring</th>
																	<th>veil-type</th>
																	<th>veil-color</th>
																	<th>ring-number</th>
																	<th>ring-type</th>
																	<th>spore-print-color</th>
																	<th>population</th>
																	<th>habitat</th>
																</tr>
															</thead>
															<tbody>
																<tr>
																	<td>poisonous</td>
																	<td>convex</td>
																	<td>smooth</td>
																	<td>brown</td>
																	<td>bruises</td>
																	<td>pungent</td>
																	<td>free</td>
																	<td>close</td>
																	<td>narrow</td>
																	<td>black</td>
																	<td>enlarging</td>
																	<td>equal</td>
																	<td>smooth</td>
																	<td>smooth</td>
																	<td>white</td>
																	<td>white</td>
																	<td>partial</td>
																	<td>white</td>
																	<td>one</td>
																	<td>pendant</td>
																	<td>black</td>
																	<td>scattered</td>
																	<td>urban</td>
																</tr>
																<tr>
																	<td>edible</td>
																	<td>convex</td>
																	<td>smooth</td>
																	<td>yellow</td>
																	<td>bruises</td>
																	<td>almond</td>
																	<td>free</td>
																	<td>close</td>
																	<td>broad</td>
																	<td>black</td>
																	<td>enlarging</td>
																	<td>club</td>
																	<td>smooth</td>
																	<td>smooth</td>
																	<td>white</td>
																	<td>white</td>
																	<td>partial</td>
																	<td>white</td>
																	<td>one</td>
																	<td>pendant</td>
																	<td>brown</td>
																	<td>numerous</td>
																	<td>grasses</td>
																</tr>
																<tr>
																	<td>edible</td>
																	<td>bell</td>
																	<td>smooth</td>
																	<td>white</td>
																	<td>bruises</td>
																	<td>anise</td>
																	<td>free</td>
																	<td>close</td>
																	<td>broad</td>
																	<td>brown</td>
																	<td>enlarging</td>
																	<td>club</td>
																	<td>smooth</td>
																	<td>smooth</td>
																	<td>white</td>
																	<td>white</td>
																	<td>partial</td>
																	<td>white</td>
																	<td>one</td>
																	<td>pendant</td>
																	<td>brown</td>
																	<td>numerous</td>
																	<td>meadows</td>
																</tr>
																<tr>
																	<td>poisonous</td>
																	<td>convex</td>
																	<td>scaly</td>
																	<td>white</td>
																	<td>bruises</td>
																	<td>pungent</td>
																	<td>free</td>
																	<td>close</td>
																	<td>narrow</td>
																	<td>brown</td>
																	<td>enlarging</td>
																	<td>equal</td>
																	<td>smooth</td>
																	<td>smooth</td>
																	<td>white</td>
																	<td>white</td>
																	<td>partial</td>
																	<td>white</td>
																	<td>one</td>
																	<td>pendant</td>
																	<td>black</td>
																	<td>scattered</td>
																	<td>urban</td>
																</tr>
																<tr>
																	<td>edible</td>
																	<td>convex</td>
																	<td>smooth</td>
																	<td>gray</td>
																	<td>no</td>
																	<td>none</td>
																	<td>free</td>
																	<td>crowded</td>
																	<td>broad</td>
																	<td>black</td>
																	<td>tapering</td>
																	<td>equal</td>
																	<td>smooth</td>
																	<td>smooth</td>
																	<td>white</td>
																	<td>white</td>
																	<td>partial</td>
																	<td>white</td>
																	<td>one</td>
																	<td>evanescent</td>
																	<td>brown</td>
																	<td>abundant</td>
																	<td>grasses</td>
																</tr>
															</tbody>
														</table>
														<p><i>Note.  We also change the type of data from strings to factors at this point.</i></p>
													</div>
												</div>
											
												<div id="Content6" class="tab-content">
													<pre class="language-r">
<code># Match the coded values with their corresponding words
for(col in colnames(mushroom)) {
    mushroom[[col]] <- name_codex[[col]][match(mushroom[[col]], rownames(name_codex))]
}

# Convert all columns to factors
df_factors <- as.data.frame(lapply(df, factor))

# Display
head(mushroom,5)
											</code></pre>
										</div>
									</div>
									<br>
									<p>This concludes this section. Now that we have a readable dataset, we can proceed to visualizing what kind of data we are dealing with.</p>
									<hr />
									<h3 id="vizmushr">Data Exploration</h3>

									<p>
										Given the large number of variables (22), it is quite complex to observe all their relationships. Therefore, we will simplify our search 
										for patterns within the dataset by reducing the number of dimensions. To this end, we will use the Multiple Correspondence Analysis (MCA) 
										method. MCA is a dimensionality reduction technique particularly useful for categorical data. It allows us to visualize the relationships 
										between different categories in our dataset. In this case, we will use MCA to visualize the relationships between different mushroom 
										characteristics and observe if they form a pattern in relation to their toxicity.
									</p>

									<div id="tab-container-4" class="tab-container">
										<div class="tabs">
											<button class="tab-link" onclick="openTab(event, 'Content7', 'tab-container-4')">Graph</button>
											<button class="tab-link" onclick="openTab(event, 'Content8', 'tab-container-4')">Code</button>
										</div>
									
										<div id="Content7" class="tab-content">
											<img src="images/mushmcar.jpg" alt="MCA Plot"  style="height:100%;">
										</div>
									
										<div id="Content8" class="tab-content">
											<pre class="language-r">
<code>library(FactoMineR)
library(ggplot2)
library(gridExtra)

# Perform MCA on 3 dimensions
mca_data <- MCA(mushroom[, 2:23], ncp = 3, graph = FALSE)
ind_coords <- as.data.frame(mca_data$ind$coord)
ind_coords$group <- mushroom[, 1]

# Plot for Dimensions 1 and 2
plot1 <- ggplot(ind_coords, aes(x = `Dim 1`, y = `Dim 2`, color = group)) +
    geom_point(size = 3, alpha = 0.5) +
    labs(x = paste("Dimension 1 (", round(mca_data$eig[1, 2], 2), "%)", sep=""),
         y = paste("Dimension 2 (", round(mca_data$eig[2, 2], 2), "%)", sep="")) +
    theme_minimal(base_family = "Helvetica") +
    theme(plot.title = element_blank(),
          legend.position = "none") +
    scale_color_manual(values = c("#990000", "#336633"))

# Plot for Dimensions 1 and 3
plot2 <- ggplot(ind_coords, aes(x = `Dim 1`, y = `Dim 3`, color = group)) +
    geom_point(size = 3, alpha = 0.5) +
    labs(x = paste("Dimension 1 (", round(mca_data$eig[1, 2], 2), "%)", sep=""),
         y = paste("Dimension 3 (", round(mca_data$eig[3, 2], 2), "%)", sep="")) +
    theme_minimal(base_family = "Helvetica") +
    theme(plot.title = element_blank(),
          legend.position = c(0.9, 0.9),
          legend.background = element_rect(color = "black", fill = "white")) +
    scale_color_manual(values = c("#990000", "#336633"))

# Display plots
grid.arrange(plot1, plot2, ncol = 2)</code>
									</pre>
										</div>
									</div>
									<br>
									<p>
										From the first MCA plot, we can see that while some clusters are well-defined, such as (1;0) and (1;7), others appear to overlap, 
										particularly in the bottom left corner (-0.5;0). This overlap suggests that this part of the data is not linearly separable. 
										To further investigate, we can introduce a third dimension, Dimension 3, and plot it against Dimension 1. In the second plot, 
										we observe that this large cluster is actually composed of smaller clusters, which still overlap but not as much as initially 
										thought. Overall, the MCA plot shows that although some clusters are clearly defined, others still overlap. Therefore, while 
										the entirety of the data is not linearly separable, a significant portion is, indicating that a non-linear model, such as a 
										Random Forest Classifier, would be a good choice for this dataset. We can also expect the model to have relatively high accuracy.
									</p>
									<hr />
									<h3 id="descmushr">Model</h3>

									<p>
										Now that we have a better understanding of the data, we can proceed with model building. We will use a Random Forest, a non-linear 
										model well-suited to this type of data. The Random Forest is an ensemble learning method that creates multiple decision trees and 
										combines their predictions to make a final prediction. This method is particularly useful for classification tasks and is known 
										for its high accuracy and robustness. We don't need to worry about many parameters; the dataset's documentation mentions achieving 
										99.8% accuracy with a single decision tree, so 10 trees should suffice to achieve near-perfect accuracy. We will train the model 
										using the usual 80% training data, 20% testing data split.

									</p>
									<div id="tab-container-5" class="tab-container">
										<div class="tabs">
											<button class="tab-link" onclick="openTab(event, 'Content9', 'tab-container-5')">Table</button>
											<button class="tab-link" onclick="openTab(event, 'Content10', 'tab-container-5')">Code</button>
										</div>
									
										<div id="Content9" class="tab-content">
											<p>Out of 1129 individuals tested, the model yields the following results:</p>
											<div class="table-wrapper">
												<table class="alt">
													<tr>
														<th></th>
														<th>Edible</th>
														<th>Poisonous</th>
													</tr>
													<tr>
														<td>Edible</td>
														<td>697</td>
														<td>0</td>
													</tr>
													<tr>
														<td>Poisonous</td>
														<td>0</td>
														<td>431</td>
													</tr>
												</table>
											<p>The model is 100.00% accurate.</p>
										</div>
									</div>

									<div id="Content10" class="tab-content">
										<pre class="language-r">
<code>library(randomForest)
library(caret)

set.seed(123)

# Data Split
mushroom[, 1] <- as.factor(mushroom[, 1])
index <- createDataPartition(mushroom[,1], p = 0.8, list = FALSE)
train_data <- mushroom[index, ]
test_data <- mushroom[-index, ]

# Create a random forest model
rf_model <- randomForest(train_data[, -1], train_data[, 1], ntree = 10)

# Test the accuracy of the model
predictions <- predict(rf_model, test_data[, -1])
confusion_matrix <- table(predictions, test_data[, 1])
confusion_matrix

# Calculate accuracy
accuracy <- sum(diag(confusion_matrix)) / sum(confusion_matrix) * 100
cat(sprintf("The model is %.2f%% accurate\n", accuracy))</code>
										</pre>
									</div>
								</div>

								<hr />

								<H3 id="webmushr">Web App</H3>

								<p>
									To make the model accessible to everyone, we will create a web application that allows users to input the characteristics of a mushroom and 
									get a prediction of whether it is edible or poisonous. We will use the Shiny R framework to create the application. The application will 
									consist of a simple form where users can input the characteristics of the mushroom, and a button to submit the form. Once the form is submitted, 
									the application will use the trained Random Forest model to make a prediction and display the result to the user. The application was built using 
									Shiny, hosted on the Shiny website, and can be accessed <a href="https://vittozcy.shinyapps.io/mush/" target="_blank">here</a>.
								</p>

								<div id="tab-container-6" class="tab-container">
									<div class="tabs">
										<button class="tab-link" onclick="openTab(event, 'Content11', 'tab-container-6')">Web App</button>
										<button class="tab-link" onclick="openTab(event, 'Content12', 'tab-container-6')">Code</button>
									</div>
									<div id="Content11" class="tab-content">
										<iframe class="responsive-iframe" src="https://vittozcy.shinyapps.io/mush/" width="940px" height="515px" frameborder="0" allowfullscreen></iframe>
									</div>
									<div id="Content12" class="tab-content">
										<pre class="language-r">
<code># Import necessary modules
library(shiny)
library(shinyjs)
library(shinythemes)

# Define the UI
ui <- (...)

# Define the server logic
server <- function(input, output, session) {
    
    # Trigger the predict button on app load
    observe({
        shinyjs::click("predict_button")
    })
    
    observeEvent(input$predict_button, {
        
        # Gather the input values into a new data frame with the same structure as train_data
        new_data <- as.data.frame(t(sapply(2:ncol(mushroom), function(i) {
            input[[paste0("var_", i)]]
        })))
        
        # Set column names to match the training data
        colnames(new_data) <- colnames(mushroom)[-1]
        
        # Convert the data frame to factor and set levels to match training data
        for (i in 1:ncol(new_data)) {
            new_data[, i] <- factor(new_data[, i], levels = levels(mushroom[, i + 1]))
        }
        
        # Predict using the random forest model
        prediction <- predict(rf_model, newdata = new_data)
        
        # Display the prediction with appropriate color
        output$prediction <- renderText({
            if (prediction == "edible") {
                shinyjs::html(id = "prediction-output", html = "<h1 style='color:green;'>😋 This mushroom is edible 😋</h1>")
            } else {
                shinyjs::html(id = "prediction-output", html = "<h1 style='color:red;'>💀 This mushroom is poisonous 💀</h1>")
            }
            NULL  # Return NULL because we directly modify the DOM
        })
        
        # Create the heatmap based on individual tree predictions
        individual_predictions <- predict(rf_model, newdata = new_data, predict.all = TRUE)$individual
        
        # Convert predictions to a data frame for ggplot
        heatmap_data <- data.frame(Tree = 1:ncol(individual_predictions),
                                   Row = rep(1:2, each = 5),
                                   Col = rep(1:5, times = 2),
                                   Prediction = factor(ifelse(individual_predictions == "edible", "edible", "poisonous"),
                                                       levels = c("poisonous", "edible")))
        
        # Render custom heatmap using ggplot2
        output$heatmap <- renderPlot({
            ggplot(heatmap_data, aes(x = factor(Col), y = factor(Row), fill = Prediction)) +
                geom_tile(color = "grey", size = 0.5) +
                scale_fill_manual(values = c("poisonous" = "red4", "edible" = "green4")) +
                geom_text(aes(
                    label = paste(
                        "Tree", 
                        ifelse(abs((Row +1) * 5 + Col - 5) %% 10 == 0, 10, abs((Row +1) * 5 + Col - 5) %% 10),
                        ifelse(
                            individual_predictions[
                                ifelse(abs((Row +1) * 5 + Col ) %% 10 == 0, 10, abs((Row +1) * 5 + Col ) %% 10)
                            ] == "poisonous", 
                            "\n 💀", 
                            "\n 😋"
                        )
                    )
                ), color = "white", size = 12) +
                theme_void() +
                theme(
                    legend.position = "none",
                    plot.title = element_text(hjust = 0.5, size = 14),
                    plot.background = element_rect(fill = "transparent", color = NA),
                    panel.background = element_rect(fill = "transparent", color = NA),
                    plot.margin = unit(c(0, 0, 0, 0), "cm")
                )
        })
        
        
    })
}

# Run the application
shinyApp(ui = ui, server = server)</code>
											</pre>
										</div>
									</div>	
									
									<p>
										The app is quite simple. Users can select the characteristics of a mushroom from the dropdown menus and click the "Compute" 
										button to get a prediction of whether the mushroom is edible or poisonous. The header of the app will display the prediction
										of the model and the heatmap will show the predictions of each tree in the Random Forest. The heatmap will display a green
										color if the tree predicts the mushroom is edible and a red color if the tree predicts the mushroom is poisonous.
									</p>
									

									<hr />

									<h3>Conclusion</h3>
									
									<p>
										And that concludes our analysis of the Mushroom dataset. We have successfully built a Random Forest model that can predict whether a mushroom is edible or poisonous with 100% accuracy. 
										We have also created a web application that allows users to input the characteristics of a mushroom and get a prediction of its toxicity. 
										We hope you enjoyed this analysis and learned something new. If you have any questions or comments, feel free to reach out to me. <br><br>
										Thank you for reading!
									</p>

									<hr />

									<h3>References</h3>
									<ul>
										<li><a href="https://archive.ics.uci.edu/ml/datasets/mushroom">UCI Machine Learning Repository: Mushroom Data Set</a></li>
										<li><a href="https://cran.r-project.org/web/packages/MCA/index.html">MCA</a></li>
										<li><a href="https://cran.r-project.org/web/packages/caret/index.html">Caret</a></li>
										<li><a href="https://cran.r-project.org/web/packages/FactoMineR/index.html">FactoMineR</a></li>
										<li><a href="https://cran.r-project.org/web/packages/randomForest/index.html">RandomForest</a></li>
										<li><a href="https://cran.r-project.org/web/packages/ggplot2/index.html">ggplot2</a></li>
										<li><a href="https://shiny.rstudio.com/">shiny app</a></li>
									</ul>
								</div>
							</section>

				<!-- Footer -->
					<footer id="footer">
						<section>
							<form action="https://api.web3forms.com/submit" method="post" >
								<div class="fields">
									<input type="hidden" name="access_key" value="fa06f4c8-1867-47c9-8431-d971454af520">
									<div class="field">
										<label for="name">Name</label>
										<input type="text" name="name" id="name" required/>
									</div>
									<div class="field">
										<label for="email">Email</label>
										<input type="text" name="email" id="email" required/>
									</div>
									<div class="field">
										<label for="message">Message</label>
										<textarea name="message" id="message" rows="3" required></textarea>
									</div>
								</div>
								<ul class="actions">
									<li><input type="submit" value="send message" /></li>
								</ul>
							</form>
						</section>
						<section class="split contact">
							<section class="alt">
								<h3>Address</h3>
								<p>19 Rue du Mont Charvin<br />
								74230 Thônes, FRANCE</p>
							</section>
							<section>
								<h3>Phone</h3>
								<p><a href="#">(+33) 641-242-973</a></p>
							</section>
							<section>
								<h3>Email</h3>
								<p><a href="#">vittozcyprien@gmail.com</a></p>
							</section>
							<section>
								<h3>Social</h3>
								<ul class="icons alt">
									<li><a href="https://www.linkedin.com/in/vittozcyprien/" class="icon brands fa-linkedin" target="_blank"><span class="label">LinkedIn</span></a></li>
								</ul>
							</section>
						</section>
					</footer>

				<!-- Copyright -->
					<div id="copyright">
						<ul><li>&copy; Cyprien Vittoz</li><li><a href="legal.html#header">Legal Mentions</a></li></ul>
					</div>

			</div>

		<!-- Scripts -->
			<script>
				document.addEventListener("DOMContentLoaded", function() {
					Prism.highlightAll();
				});
			</script>
			<script src="assets/js/prism.js"></script>
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.scrollex.min.js"></script>
			<script src="assets/js/jquery.scrolly.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>
	</body>
</html>